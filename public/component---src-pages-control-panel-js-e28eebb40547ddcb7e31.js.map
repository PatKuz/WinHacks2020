{"version":3,"sources":["webpack://class-connect/./src/pages/control-panel.js"],"names":["StyledCentered","styled","Centered","Background","IndexPage","_initFirebase","state","roomCode","rooms","unsubRooms","loadData","Promise","resolve","reject","resolveOnce","doc","props","firebase","onSnapshot","querySnapshot","docs","map","id","data","setState","setRoomCode","attemptLogin","login","doSignInWithEmail","email","password","then","navigate","catch","err","console","error","componentDidMount","this","componentDidUpdate","prevProps","componentWillUnmount","render","room","find","r","title","route","size","React","withFirebase"],"mappings":"oQAaMA,GAAiBC,aAAOC,MAAV,gFAAGD,CAAH,yBACDE,KAGbC,E,oJACLC,eAAgB,E,EAChBC,MAAQ,CACPC,SAAU,GACVC,MAAO,M,EAERC,WAAa,K,EAcbC,U,iBAAW,qFACV,EAAKL,eAAgB,EADX,SAGU,IAAIM,SAAQ,SAACC,EAASC,GACzC,IAAIC,EAAc,SAACC,GAClBD,EAAc,kBAAM,MACpBF,EAAQG,IAGT,EAAKN,WAAa,EAAKO,MAAMC,SAC3BT,QACAU,YAAW,SAACC,GACZ,IAAMX,EAAQW,EAAcC,KAAKC,KAAI,SAACN,GACrC,OAAO,OAAP,QACCO,GAAIP,EAAIO,IACLP,EAAIQ,WAGT,EAAKC,SAAS,CAAEhB,UAChBM,EAAYN,KACVK,MApBK,yD,EAwBXY,YAAc,SAAClB,GACd,EAAKiB,SAAS,CAACjB,c,EAGhBmB,aAAe,SAACC,GACf,EAAKX,MAAMC,SAASW,kBAAkBD,EAAME,MAAOF,EAAMG,UAAUC,MAAK,YACvEC,QAAS,qBACPC,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,O,0CA3C9BG,kBAAA,WACEC,KAAKtB,MAAMC,WAAaqB,KAAKjC,eAAeiC,KAAK5B,Y,EAGnD6B,mBAAA,SAAmBC,GACjBF,KAAKtB,MAAMC,WAAaqB,KAAKjC,eAAeiC,KAAK5B,Y,EAGnD+B,qBAAA,WAC6B,mBAApBH,KAAK7B,YAA2B6B,KAAK7B,c,EAqCjDiC,OAAA,WAAU,IAAD,EACoBJ,KAAKhC,MAAzBE,EADA,EACAA,MAAOD,EADP,EACOA,SAGToC,EAAOnC,EAAQA,EAAMoC,MAAK,SAACC,GAAD,OAAOA,EAAEvB,KAAOf,KAAY,KAE5D,MAAiB,KAAbA,EAEC,gCACF,gBAAC,IAAD,CAAKuC,MAAM,OAAOC,MAAM,MACxB,gBAAC/C,EAAD,KACC,gBAAC,IAAD,CAAMgD,KAAK,UACX,gBAAC,IAAD,CAAMvB,YAAaa,KAAKb,gBAInBkB,QAEJ,gCACF,gBAAC,IAAD,CAAKG,MAAM,OAAOC,MAAM,MACxB,gBAAC/C,EAAD,KACC,gBAAC,IAAD,CAAMgD,KAAK,UACX,+CACA,gBAAC,IAAD,CAAMvB,YAAaa,KAAKb,gBAMvB,gCACF,gBAAC,IAAD,CAAKqB,MAAM,OAAOC,MAAM,MACxB,gBAAC,IAAD,CAAMJ,KAAMA,M,GArFOM,aA2FxB,WAAeC,QAAa9C","file":"component---src-pages-control-panel-js-e28eebb40547ddcb7e31.js","sourcesContent":["import * as React from \"react\"\r\nimport { navigate } from \"gatsby\";\r\nimport styled from 'styled-components'\r\n\r\nimport {withFirebase} from \"../api/\"\r\nimport { Centered } from \"../styles/global\";\r\nimport Card from \"../components/Card\";\r\nimport Logo from \"../components/Logo\";\r\nimport SEO from \"../components/SEO\";\r\nimport Room from \"../components/Room\";\r\n\r\nimport Background from \"../images/home-background.png\";\r\n\r\nconst StyledCentered = styled(Centered)`\r\n\tbackground: url(${Background});\r\n`;\r\n\r\nclass IndexPage extends React.Component {\r\n\t_initFirebase = false;\r\n\tstate = {\r\n\t\troomCode: \"\",\r\n\t\trooms: null,\r\n\t}\r\n\tunsubRooms = null;\r\n\t\r\n    componentDidMount() {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\t\r\n    componentDidUpdate(prevProps) {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\t\r\n    componentWillUnmount() {\r\n\t\tif (typeof this.unsubRooms === \"function\") this.unsubRooms();\r\n\t}\r\n\t\r\n\tloadData = async () => {\r\n\t\tthis._initFirebase = true;\r\n\t\t\r\n\t\tconst rooms = await new Promise((resolve, reject) => {\r\n\t\t\tlet resolveOnce = (doc) => {\r\n\t\t\t\tresolveOnce = () => null;\r\n\t\t\t\tresolve(doc);\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tthis.unsubRooms = this.props.firebase\r\n\t\t\t\t.rooms()\r\n\t\t\t\t.onSnapshot((querySnapshot) => {\r\n\t\t\t\t\tconst rooms = querySnapshot.docs.map((doc) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid: doc.id,\r\n\t\t\t\t\t\t\t...doc.data(),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.setState({ rooms });\r\n\t\t\t\t\tresolveOnce(rooms);\r\n\t\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n\t\r\n\tsetRoomCode = (roomCode) => {\r\n\t\tthis.setState({roomCode})\r\n\t};\r\n\t\r\n\tattemptLogin = (login) => {\r\n\t\tthis.props.firebase.doSignInWithEmail(login.email, login.password).then(() => {\r\n\t\t\tnavigate(\"/control-panel\");\r\n\t\t}).catch((err) => console.error(err));\r\n\t};\r\n\t\r\n\trender() {\r\n\t\tconst { rooms, roomCode } = this.state;\r\n\t\t\r\n\t\t\r\n\t\tconst room = rooms ? rooms.find((r) => r.id === roomCode) : null;\r\n\t\t\r\n\t\tif (roomCode === \"\")\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse if (room === undefined || room === null)\r\n\t\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<h1> Room not found! </h1>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t\t);\r\n\t\telse\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Room\" route=\"/\" />\r\n\t\t\t\t\t<Room room={room} />\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t}\r\n}\r\n\r\nexport default withFirebase(IndexPage);\r\n"],"sourceRoot":""}