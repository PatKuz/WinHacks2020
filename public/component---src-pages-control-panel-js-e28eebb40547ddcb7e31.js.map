{"version":3,"sources":["webpack://class-connect/./src/pages/control-panel.js"],"names":["StyledCentered","styled","Centered","Background","IndexPage","_initFirebase","state","roomCode","rooms","unsubRooms","loadData","Promise","resolve","reject","resolveOnce","doc","props","firebase","onSnapshot","querySnapshot","docs","map","id","data","setState","setRoomCode","attemptLogin","login","doSignInWithEmail","email","password","then","navigate","catch","err","console","error","componentDidMount","this","componentDidUpdate","prevProps","componentWillUnmount","render","room","find","r","title","route","size","React","withFirebase"],"mappings":"oQAaMA,GAAiBC,aAAOC,MAAV,gFAAGD,CAAH,yBACDE,KAGbC,E,oJACLC,eAAgB,E,EAChBC,MAAQ,CACPC,SAAU,GACVC,MAAO,M,EAERC,WAAa,K,EAcbC,U,iBAAW,qFACV,EAAKL,eAAgB,EADX,SAGU,IAAIM,SAAQ,SAACC,EAASC,GACzC,IAAIC,EAAc,SAACC,GAClBD,EAAc,kBAAM,MACpBF,EAAQG,IAGT,EAAKN,WAAa,EAAKO,MAAMC,SAC3BT,QACAU,YAAW,SAACC,GACZ,IAAMX,EAAQW,EAAcC,KAAKC,KAAI,SAACN,GACrC,OAAO,OAAP,QACCO,GAAIP,EAAIO,IACLP,EAAIQ,WAGT,EAAKC,SAAS,CAAEhB,UAChBM,EAAYN,KACVK,MApBK,yD,EAwBXY,YAAc,SAAClB,GACd,EAAKiB,SAAS,CAACjB,c,EAGhBmB,aAAe,SAACC,GACf,EAAKX,MAAMC,SAASW,kBAAkBD,EAAME,MAAOF,EAAMG,UAAUC,MAAK,YACvEC,QAAS,qBACPC,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,O,0CA3C9BG,kBAAA,WACEC,KAAKtB,MAAMC,WAAaqB,KAAKjC,eAAeiC,KAAK5B,Y,EAGnD6B,mBAAA,SAAmBC,GACjBF,KAAKtB,MAAMC,WAAaqB,KAAKjC,eAAeiC,KAAK5B,Y,EAGnD+B,qBAAA,WAC6B,mBAApBH,KAAK7B,YAA2B6B,KAAK7B,c,EAqCjDiC,OAAA,WAAU,IAAD,EACoBJ,KAAKhC,MAAzBE,EADA,EACAA,MAAOD,EADP,EACOA,SAGToC,EAAOnC,EAAQA,EAAMoC,MAAK,SAACC,GAAD,OAAOA,EAAEvB,KAAOf,KAAY,KAE5D,MAAiB,KAAbA,EAEC,gCACF,gBAAC,IAAD,CAAKuC,MAAM,OAAOC,MAAM,MACxB,gBAAC/C,EAAD,KACC,gBAAC,IAAD,CAAMgD,KAAK,UACX,gBAAC,IAAD,CAAMvB,YAAaa,KAAKb,gBAInBkB,QAEJ,gCACF,gBAAC,IAAD,CAAKG,MAAM,OAAOC,MAAM,MACxB,gBAAC/C,EAAD,KACC,gBAAC,IAAD,CAAMgD,KAAK,UACX,+CACA,gBAAC,IAAD,CAAMvB,YAAaa,KAAKb,gBAMvB,gCACF,gBAAC,IAAD,CAAKqB,MAAM,OAAOC,MAAM,MACxB,gBAAC,IAAD,CAAMJ,KAAMA,M,GArFOM,aA2FxB,WAAeC,QAAa9C","file":"component---src-pages-control-panel-js-e28eebb40547ddcb7e31.js","sourcesContent":["import * as React from \"react\"\nimport { navigate } from \"gatsby\";\nimport styled from 'styled-components'\n\nimport {withFirebase} from \"../api/\"\nimport { Centered } from \"../styles/global\";\nimport Card from \"../components/Card\";\nimport Logo from \"../components/Logo\";\nimport SEO from \"../components/SEO\";\nimport Room from \"../components/Room\";\n\nimport Background from \"../images/home-background.png\";\n\nconst StyledCentered = styled(Centered)`\n\tbackground: url(${Background});\n`;\n\nclass IndexPage extends React.Component {\n\t_initFirebase = false;\n\tstate = {\n\t\troomCode: \"\",\n\t\trooms: null,\n\t}\n\tunsubRooms = null;\n\t\n    componentDidMount() {\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\n\t}\n\t\n    componentDidUpdate(prevProps) {\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\n\t}\n\t\n    componentWillUnmount() {\n\t\tif (typeof this.unsubRooms === \"function\") this.unsubRooms();\n\t}\n\t\n\tloadData = async () => {\n\t\tthis._initFirebase = true;\n\t\t\n\t\tconst rooms = await new Promise((resolve, reject) => {\n\t\t\tlet resolveOnce = (doc) => {\n\t\t\t\tresolveOnce = () => null;\n\t\t\t\tresolve(doc);\n\t\t\t};\n\t\t\t\n\t\t\tthis.unsubRooms = this.props.firebase\n\t\t\t\t.rooms()\n\t\t\t\t.onSnapshot((querySnapshot) => {\n\t\t\t\t\tconst rooms = querySnapshot.docs.map((doc) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: doc.id,\n\t\t\t\t\t\t\t...doc.data(),\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tthis.setState({ rooms });\n\t\t\t\t\tresolveOnce(rooms);\n\t\t\t\t}, reject);\n\t\t});\n\t}\n\t\n\tsetRoomCode = (roomCode) => {\n\t\tthis.setState({roomCode})\n\t};\n\t\n\tattemptLogin = (login) => {\n\t\tthis.props.firebase.doSignInWithEmail(login.email, login.password).then(() => {\n\t\t\tnavigate(\"/control-panel\");\n\t\t}).catch((err) => console.error(err));\n\t};\n\t\n\trender() {\n\t\tconst { rooms, roomCode } = this.state;\n\t\t\n\t\t\n\t\tconst room = rooms ? rooms.find((r) => r.id === roomCode) : null;\n\t\t\n\t\tif (roomCode === \"\")\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\n\t\t\t\t\t<StyledCentered>\n\t\t\t\t\t\t<Logo size=\"large\"/>\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} />\n\t\t\t\t\t</StyledCentered>\n\t\t\t\t</>\n\t\t\t);\n\t\telse if (room === undefined || room === null)\n\t\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\n\t\t\t\t\t<StyledCentered>\n\t\t\t\t\t\t<Logo size=\"large\"/>\n\t\t\t\t\t\t<h1> Room not found! </h1>\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} />\n\t\t\t\t\t</StyledCentered>\n\t\t\t\t</>\n\t\t\t\t);\n\t\telse\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Room\" route=\"/\" />\n\t\t\t\t\t<Room room={room} />\n\t\t\t\t</>\n\t\t\t);\n\t}\n}\n\nexport default withFirebase(IndexPage);\n"],"sourceRoot":""}