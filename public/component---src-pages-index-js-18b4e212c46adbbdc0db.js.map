{"version":3,"sources":["webpack://class-connect/./src/images/pattern_3.svg","webpack://class-connect/./src/pages/index.js"],"names":["StyledCentered","styled","Centered","Background","IndexPage","props","loadData","_initFirebase","Promise","resolve","reject","resolveOnce","doc","unsubRooms","firebase","rooms","onSnapshot","querySnapshot","docs","map","id","data","setState","setRoomCode","roomCode","setErrorMsg","errorMsg","forceUpdate","attemptLogin","email","password","doSignInWithEmail","then","navigate","catch","err","console","log","state","componentDidMount","this","componentDidUpdate","prevProps","componentWillUnmount","render","room","find","r","SEO","title","route","Logo","size","Card","Room","React","withFirebase"],"mappings":"iSAAA,EAAe,IAA0B,wDCanCA,GAAiBC,aAAOC,MAAV,2EAAGD,CAAH,yBACDE,GAGbC,E,YACL,WAAYC,GAAQ,IAAD,SAClB,cAAMA,IAAN,MAwBDC,UAzBmB,iBAyBR,qFACV,EAAKC,eAAgB,EADX,SAGU,IAAIC,SAAQ,SAACC,EAASC,GACzC,IAAIC,EAAc,SAACC,GAClBD,EAAc,kBAAM,MACpBF,EAAQG,IAGT,EAAKC,WAAa,EAAKR,MAAMS,SAC3BC,QACAC,YAAW,SAACC,GACZ,IAAMF,EAAQE,EAAcC,KAAKC,KAAI,SAACP,GACrC,OAAO,OAAP,QACCQ,GAAIR,EAAIQ,IACLR,EAAIS,WAGT,EAAKC,SAAS,CAAEP,UAChBJ,EAAYI,KACVL,MApBK,yDAzBQ,EAiDnBa,YAAc,SAACC,GACd,EAAKF,SAAS,CAACE,SAAUA,KAlDP,EAqDnBC,YAAc,SAACC,GACd,EAAKJ,SAAS,CAACI,SAAUA,IACzB,EAAKC,eAvDa,EA0DnBC,aAAe,SAACC,EAAOC,GACtB,EAAKzB,MAAMS,SAASiB,kBAAkBF,EAAOC,GAAUE,MAAK,YAC3DC,QAAS,qBACPC,OAAM,SAACC,GACTC,QAAQC,IAAIF,GACZ,EAAKV,YAAY,qBA5DlB,EAAKa,MAAQ,CACZd,SAAU,GACVT,MAAO,KACPW,SAAU,IAGX,EAAKnB,eAAgB,EACrB,EAAKM,WAAa,KAVA,G,uCAahB0B,kBAAA,WACEC,KAAKnC,MAAMS,WAAa0B,KAAKjC,eAAeiC,KAAKlC,Y,EAGnDmC,mBAAA,SAAmBC,GACjBF,KAAKnC,MAAMS,WAAa0B,KAAKjC,eAAeiC,KAAKlC,Y,EAGnDqC,qBAAA,WAC6B,mBAApBH,KAAK3B,YAA2B2B,KAAK3B,c,EA6CjD+B,OAAA,WAAU,IAAD,EAC8BJ,KAAKF,MAAnCvB,EADA,EACAA,MAAOS,EADP,EACOA,SAAUE,EADjB,EACiBA,SAEnBmB,EAAO9B,EAAQA,EAAM+B,MAAK,SAACC,GAAD,OAAOA,EAAE3B,KAAOI,KAAY,KAM5D,OAJa,OAATqB,GAA8B,KAAbrB,GACpBgB,KAAKf,YAAY,mBAGD,KAAbD,EAEC,gCACF,gBAACwB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,gBAACC,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAInDiB,QAEJ,gCACF,gBAACG,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,+CACA,gBAACC,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAItC,KAAbF,EAEJ,gCACF,gBAACsB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,8BAAMZ,KAAKF,MAAMZ,SAAjB,KACA,gBAAC2B,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAMvD,gCACF,gBAACoB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAACI,EAAA,EAAD,CAAMT,KAAMA,M,GAjHOU,aAuHxB,GAAeC,QAAapD","file":"component---src-pages-index-js-18b4e212c46adbbdc0db.js","sourcesContent":["export default __webpack_public_path__ + \"static/pattern_3-cc394dbce1344a03a3f87d3c5eaaa3e1.svg\";","import * as React from \"react\"\r\nimport styled from 'styled-components'\r\nimport { navigate } from \"gatsby\";\r\n\r\nimport {withFirebase} from \"../api/\"\r\nimport { Centered } from \"../styles/global\";\r\nimport Card from \"../components/Card\";\r\nimport Logo from \"../components/Logo\";\r\nimport SEO from \"../components/SEO\";\r\nimport Room from \"../components/Room\";\r\n\r\nimport Background from \"../images/pattern_3.svg\";\r\n\r\nconst StyledCentered = styled(Centered)`\r\n\tbackground: url(${Background});\r\n`;\r\n\r\nclass IndexPage extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\r\n\t\tthis.state = {\r\n\t\t\troomCode: \"\",\r\n\t\t\trooms: null,\r\n\t\t\terrorMsg: \"\",\r\n\t\t}\r\n\r\n\t\tthis._initFirebase = false;\r\n\t\tthis.unsubRooms = null;\r\n\t}\r\n\r\n    componentDidMount() {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\r\n    componentDidUpdate(prevProps) {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\r\n    componentWillUnmount() {\r\n\t\tif (typeof this.unsubRooms === \"function\") this.unsubRooms();\r\n\t}\r\n\r\n\tloadData = async () => {\r\n\t\tthis._initFirebase = true;\r\n\r\n\t\tconst rooms = await new Promise((resolve, reject) => {\r\n\t\t\tlet resolveOnce = (doc) => {\r\n\t\t\t\tresolveOnce = () => null;\r\n\t\t\t\tresolve(doc);\r\n\t\t\t};\r\n\r\n\t\t\tthis.unsubRooms = this.props.firebase\r\n\t\t\t\t.rooms()\r\n\t\t\t\t.onSnapshot((querySnapshot) => {\r\n\t\t\t\t\tconst rooms = querySnapshot.docs.map((doc) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid: doc.id,\r\n\t\t\t\t\t\t\t...doc.data(),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.setState({ rooms });\r\n\t\t\t\t\tresolveOnce(rooms);\r\n\t\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n\r\n\tsetRoomCode = (roomCode) => {\r\n\t\tthis.setState({roomCode: roomCode})\r\n\t};\r\n\r\n\tsetErrorMsg = (errorMsg) => {\r\n\t\tthis.setState({errorMsg: errorMsg});\r\n\t\tthis.forceUpdate();\r\n\t}\r\n\r\n\tattemptLogin = (email, password) => {\r\n\t\tthis.props.firebase.doSignInWithEmail(email, password).then(() => {\r\n\t\t\tnavigate(\"/control-panel\");\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.log(err);\r\n\t\t\tthis.setErrorMsg(\"Login Failed!\");\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { rooms, roomCode, errorMsg } = this.state;\r\n\r\n\t\tconst room = rooms ? rooms.find((r) => r.id === roomCode) : null;\r\n\r\n\t\tif (room === null && roomCode !== \"\") {\r\n\t\t\tthis.setErrorMsg(\"Room not found!\");\r\n\t\t}\r\n\r\n\t\tif (roomCode === \"\")\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse if (room === null || room === undefined)\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<h1> Room not found! </h1>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse if (errorMsg !== \"\")\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<h1> {this.state.errorMsg} </h1>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Room\" route=\"/\" />\r\n\t\t\t\t\t<Room room={room} />\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t}\r\n}\r\n\r\nexport default withFirebase(IndexPage);\r\n"],"sourceRoot":""}