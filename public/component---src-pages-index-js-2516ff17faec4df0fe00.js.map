{"version":3,"sources":["webpack://class-connect/./src/images/pattern.svg","webpack://class-connect/./src/pages/index.js"],"names":["StyledCentered","styled","Centered","Background","IndexPage","props","loadData","_initFirebase","Promise","resolve","reject","resolveOnce","doc","unsubRooms","firebase","rooms","onSnapshot","querySnapshot","docs","map","id","data","setState","setRoomCode","roomCode","setErrorMsg","errorMsg","forceUpdate","attemptLogin","email","password","doSignInWithEmail","then","navigate","catch","err","console","log","state","componentDidMount","this","componentDidUpdate","prevProps","componentWillUnmount","render","room","find","r","SEO","title","route","Logo","size","Card","Room","React","withFirebase"],"mappings":"iSAAA,EAAe,IAA0B,sDCanCA,GAAiBC,aAAOC,MAAV,2EAAGD,CAAH,yBACDE,GAGbC,E,YACL,WAAYC,GAAQ,IAAD,SAClB,cAAMA,IAAN,MAwBDC,UAzBmB,iBAyBR,qFACV,EAAKC,eAAgB,EADX,SAGU,IAAIC,SAAQ,SAACC,EAASC,GACzC,IAAIC,EAAc,SAACC,GAClBD,EAAc,kBAAM,MACpBF,EAAQG,IAGT,EAAKC,WAAa,EAAKR,MAAMS,SAC3BC,QACAC,YAAW,SAACC,GACZ,IAAMF,EAAQE,EAAcC,KAAKC,KAAI,SAACP,GACrC,OAAO,OAAP,QACCQ,GAAIR,EAAIQ,IACLR,EAAIS,WAGT,EAAKC,SAAS,CAAEP,UAChBJ,EAAYI,KACVL,MApBK,yDAzBQ,EAiDnBa,YAAc,SAACC,GACd,EAAKF,SAAS,CAACE,SAAUA,KAlDP,EAqDnBC,YAAc,SAACC,GACd,EAAKJ,SAAS,CAACI,SAAUA,IACzB,EAAKC,eAvDa,EA0DnBC,aAAe,SAACC,EAAOC,GACtB,EAAKzB,MAAMS,SAASiB,kBAAkBF,EAAOC,GAAUE,MAAK,YAC3DC,QAAS,qBACPC,OAAM,SAACC,GACTC,QAAQC,IAAIF,GACZ,EAAKV,YAAY,qBA5DlB,EAAKa,MAAQ,CACZd,SAAU,GACVT,MAAO,KACPW,SAAU,IAGX,EAAKnB,eAAgB,EACrB,EAAKM,WAAa,KAVA,G,uCAahB0B,kBAAA,WACEC,KAAKnC,MAAMS,WAAa0B,KAAKjC,eAAeiC,KAAKlC,Y,EAGnDmC,mBAAA,SAAmBC,GACjBF,KAAKnC,MAAMS,WAAa0B,KAAKjC,eAAeiC,KAAKlC,Y,EAGnDqC,qBAAA,WAC6B,mBAApBH,KAAK3B,YAA2B2B,KAAK3B,c,EA6CjD+B,OAAA,WAAU,IAAD,EAC8BJ,KAAKF,MAAnCvB,EADA,EACAA,MAAOS,EADP,EACOA,SAAUE,EADjB,EACiBA,SAEnBmB,EAAO9B,EAAQA,EAAM+B,MAAK,SAACC,GAAD,OAAOA,EAAE3B,KAAOI,KAAY,KAM5D,OAJa,OAATqB,GAA8B,KAAbrB,GACpBgB,KAAKf,YAAY,mBAGD,KAAbD,EAEC,gCACF,gBAACwB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,gBAACC,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAInDiB,QAEJ,gCACF,gBAACG,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,+CACA,gBAACC,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAItC,KAAbF,EAEJ,gCACF,gBAACsB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAAClD,EAAD,KACC,gBAACmD,EAAA,EAAD,CAAMC,KAAK,UACX,8BAAMZ,KAAKF,MAAMZ,SAAjB,KACA,gBAAC2B,EAAA,EAAD,CAAM9B,YAAaiB,KAAKjB,YAAaK,aAAcY,KAAKZ,iBAMvD,gCACF,gBAACoB,EAAA,EAAD,CAAKC,MAAM,OAAOC,MAAM,MACxB,gBAACI,EAAA,EAAD,CAAMT,KAAMA,M,GAjHOU,aAuHxB,GAAeC,QAAapD","file":"component---src-pages-index-js-2516ff17faec4df0fe00.js","sourcesContent":["export default __webpack_public_path__ + \"static/pattern-1729fa2db0774d7afd40d9c4e04afae5.svg\";","import * as React from \"react\"\nimport styled from 'styled-components'\nimport { navigate } from \"gatsby\";\n\nimport {withFirebase} from \"../api/\"\nimport { Centered } from \"../styles/global\";\nimport Card from \"../components/Card\";\nimport Logo from \"../components/Logo\";\nimport SEO from \"../components/SEO\";\nimport Room from \"../components/Room\";\n\nimport Background from \"../images/pattern.svg\";\n\nconst StyledCentered = styled(Centered)`\n\tbackground: url(${Background});\n`;\n\nclass IndexPage extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\troomCode: \"\",\n\t\t\trooms: null,\n\t\t\terrorMsg: \"\",\n\t\t}\n\n\t\tthis._initFirebase = false;\n\t\tthis.unsubRooms = null;\n\t}\n\n    componentDidMount() {\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\n\t}\n\n    componentDidUpdate(prevProps) {\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\n\t}\n\n    componentWillUnmount() {\n\t\tif (typeof this.unsubRooms === \"function\") this.unsubRooms();\n\t}\n\n\tloadData = async () => {\n\t\tthis._initFirebase = true;\n\n\t\tconst rooms = await new Promise((resolve, reject) => {\n\t\t\tlet resolveOnce = (doc) => {\n\t\t\t\tresolveOnce = () => null;\n\t\t\t\tresolve(doc);\n\t\t\t};\n\n\t\t\tthis.unsubRooms = this.props.firebase\n\t\t\t\t.rooms()\n\t\t\t\t.onSnapshot((querySnapshot) => {\n\t\t\t\t\tconst rooms = querySnapshot.docs.map((doc) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tid: doc.id,\n\t\t\t\t\t\t\t...doc.data(),\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tthis.setState({ rooms });\n\t\t\t\t\tresolveOnce(rooms);\n\t\t\t\t}, reject);\n\t\t});\n\t}\n\n\tsetRoomCode = (roomCode) => {\n\t\tthis.setState({roomCode: roomCode})\n\t};\n\n\tsetErrorMsg = (errorMsg) => {\n\t\tthis.setState({errorMsg: errorMsg});\n\t\tthis.forceUpdate();\n\t}\n\n\tattemptLogin = (email, password) => {\n\t\tthis.props.firebase.doSignInWithEmail(email, password).then(() => {\n\t\t\tnavigate(\"/control-panel\");\n\t\t}).catch((err) => {\n\t\t\tconsole.log(err);\n\t\t\tthis.setErrorMsg(\"Login Failed!\");\n\t\t});\n\t};\n\n\trender() {\n\t\tconst { rooms, roomCode, errorMsg } = this.state;\n\n\t\tconst room = rooms ? rooms.find((r) => r.id === roomCode) : null;\n\n\t\tif (room === null && roomCode !== \"\") {\n\t\t\tthis.setErrorMsg(\"Room not found!\");\n\t\t}\n\n\t\tif (roomCode === \"\")\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\n\t\t\t\t\t<StyledCentered>\n\t\t\t\t\t\t<Logo size=\"large\"/>\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\n\t\t\t\t\t</StyledCentered>\n\t\t\t\t</>\n\t\t\t);\n\t\telse if (room === null || room === undefined)\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\n\t\t\t\t\t<StyledCentered>\n\t\t\t\t\t\t<Logo size=\"large\"/>\n\t\t\t\t\t\t<h1> Room not found! </h1>\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\n\t\t\t\t\t</StyledCentered>\n\t\t\t\t</>\n\t\t\t);\n\t\telse if (errorMsg !== \"\")\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\n\t\t\t\t\t<StyledCentered>\n\t\t\t\t\t\t<Logo size=\"large\"/>\n\t\t\t\t\t\t<h1> {this.state.errorMsg} </h1>\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\n\t\t\t\t\t</StyledCentered>\n\t\t\t\t</>\n\t\t\t);\n\t\telse\n\t\t\treturn (\n\t\t\t    <>\n\t\t\t\t\t<SEO title=\"Room\" route=\"/\" />\n\t\t\t\t\t<Room room={room} />\n\t\t\t\t</>\n\t\t\t);\n\t}\n}\n\nexport default withFirebase(IndexPage);\n"],"sourceRoot":""}