{"version":3,"sources":["webpack://class-connect/./src/pages/index.js"],"names":["StyledCentered","styled","Centered","Background","IndexPage","props","loadData","_initFirebase","Promise","resolve","reject","resolveOnce","doc","unsubRooms","firebase","rooms","onSnapshot","querySnapshot","docs","map","id","data","setState","setRoomCode","roomCode","setErrorMsg","errorMsg","attemptLogin","email","password","doSignInWithEmail","then","navigate","catch","err","console","log","state","componentDidMount","this","componentDidUpdate","prevProps","componentWillUnmount","render","room","find","r","title","route","size","React","withFirebase"],"mappings":"qQAaMA,GAAiBC,aAAOC,MAAV,2EAAGD,CAAH,yBACDE,KAGbC,E,YACL,WAAYC,GAAQ,IAAD,SAClB,cAAMA,IAAN,MAwBDC,UAzBmB,iBAyBR,qFACV,EAAKC,eAAgB,EADX,SAGU,IAAIC,SAAQ,SAACC,EAASC,GACzC,IAAIC,EAAc,SAACC,GAClBD,EAAc,kBAAM,MACpBF,EAAQG,IAGT,EAAKC,WAAa,EAAKR,MAAMS,SAC3BC,QACAC,YAAW,SAACC,GACZ,IAAMF,EAAQE,EAAcC,KAAKC,KAAI,SAACP,GACrC,OAAO,OAAP,QACCQ,GAAIR,EAAIQ,IACLR,EAAIS,WAGT,EAAKC,SAAS,CAAEP,UAChBJ,EAAYI,KACVL,MApBK,yDAzBQ,EAiDnBa,YAAc,SAACC,GACd,EAAKF,SAAS,CAACE,cAlDG,EAqDnBC,YAAc,SAACC,GACd,EAAKJ,SAAS,CAACI,cAtDG,EAyDnBC,aAAe,SAACC,EAAOC,GACtB,EAAKxB,MAAMS,SAASgB,kBAAkBF,EAAOC,GAAUE,MAAK,YAC3DC,QAAS,qBACPC,OAAM,SAACC,GACTC,QAAQC,IAAIF,GACZ,EAAKT,YAAY,qBA3DlB,EAAKY,MAAQ,CACZb,SAAU,GACVT,MAAO,KACPW,SAAU,IAGX,EAAKnB,eAAgB,EACrB,EAAKM,WAAa,KAVA,G,uCAahByB,kBAAA,WACEC,KAAKlC,MAAMS,WAAayB,KAAKhC,eAAegC,KAAKjC,Y,EAGnDkC,mBAAA,SAAmBC,GACjBF,KAAKlC,MAAMS,WAAayB,KAAKhC,eAAegC,KAAKjC,Y,EAGnDoC,qBAAA,WAC6B,mBAApBH,KAAK1B,YAA2B0B,KAAK1B,c,EA4CjD8B,OAAA,WAAU,IAAD,EAC8BJ,KAAKF,MAAnCtB,EADA,EACAA,MAAOS,EADP,EACOA,SAAUE,EADjB,EACiBA,SAEnBkB,EAAO7B,EAAQA,EAAM8B,MAAK,SAACC,GAAD,OAAOA,EAAE1B,KAAOI,KAAY,KAM5D,OAJa,OAAToB,GAA8B,KAAbpB,GACpBe,KAAKd,YAAY,mBAGD,KAAbD,EAEC,gCACF,gBAAC,IAAD,CAAKuB,MAAM,OAAOC,MAAM,MACxB,gBAAChD,EAAD,KACC,gBAAC,IAAD,CAAMiD,KAAK,UACX,gBAAC,IAAD,CAAM1B,YAAagB,KAAKhB,YAAaI,aAAcY,KAAKZ,iBAInDiB,QAEJ,gCACF,gBAAC,IAAD,CAAKG,MAAM,OAAOC,MAAM,MACxB,gBAAChD,EAAD,KACC,gBAAC,IAAD,CAAMiD,KAAK,UACX,+CACA,gBAAC,IAAD,CAAM1B,YAAagB,KAAKhB,YAAaI,aAAcY,KAAKZ,iBAItC,KAAbD,EAEJ,gCACF,gBAAC,IAAD,CAAKqB,MAAM,OAAOC,MAAM,MACxB,gBAAChD,EAAD,KACC,gBAAC,IAAD,CAAMiD,KAAK,UACX,8BAAMV,KAAKF,MAAMX,SAAjB,KACA,gBAAC,IAAD,CAAMH,YAAagB,KAAKhB,YAAaI,aAAcY,KAAKZ,iBAMvD,gCACF,gBAAC,IAAD,CAAKoB,MAAM,OAAOC,MAAM,MACxB,gBAAC,IAAD,CAAMJ,KAAMA,M,GAhHOM,aAsHxB,WAAeC,QAAa/C","file":"component---src-pages-index-js-878140962c328990fb56.js","sourcesContent":["import * as React from \"react\"\r\nimport styled from 'styled-components'\r\nimport { navigate } from \"gatsby\";\r\n\r\nimport {withFirebase} from \"../api/\"\r\nimport { Centered } from \"../styles/global\";\r\nimport Card from \"../components/Card\";\r\nimport Logo from \"../components/Logo\";\r\nimport SEO from \"../components/SEO\";\r\nimport Room from \"../components/Room\";\r\n\r\nimport Background from \"../images/home-background.png\";\r\n\r\nconst StyledCentered = styled(Centered)`\r\n\tbackground: url(${Background});\r\n`;\r\n\r\nclass IndexPage extends React.Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\t\r\n\t\tthis.state = {\r\n\t\t\troomCode: \"\",\r\n\t\t\trooms: null,\r\n\t\t\terrorMsg: \"\",\r\n\t\t}\r\n\t\t\r\n\t\tthis._initFirebase = false;\r\n\t\tthis.unsubRooms = null;\r\n\t}\r\n\t\r\n    componentDidMount() {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\t\r\n    componentDidUpdate(prevProps) {\r\n\t\tif (this.props.firebase && !this._initFirebase) this.loadData();\r\n\t}\r\n\t\r\n    componentWillUnmount() {\r\n\t\tif (typeof this.unsubRooms === \"function\") this.unsubRooms();\r\n\t}\r\n\t\r\n\tloadData = async () => {\r\n\t\tthis._initFirebase = true;\r\n\t\t\r\n\t\tconst rooms = await new Promise((resolve, reject) => {\r\n\t\t\tlet resolveOnce = (doc) => {\r\n\t\t\t\tresolveOnce = () => null;\r\n\t\t\t\tresolve(doc);\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tthis.unsubRooms = this.props.firebase\r\n\t\t\t\t.rooms()\r\n\t\t\t\t.onSnapshot((querySnapshot) => {\r\n\t\t\t\t\tconst rooms = querySnapshot.docs.map((doc) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid: doc.id,\r\n\t\t\t\t\t\t\t...doc.data(),\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.setState({ rooms });\r\n\t\t\t\t\tresolveOnce(rooms);\r\n\t\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n\t\r\n\tsetRoomCode = (roomCode) => {\r\n\t\tthis.setState({roomCode})\r\n\t};\r\n\t\r\n\tsetErrorMsg = (errorMsg) => {\r\n\t\tthis.setState({errorMsg});\r\n\t}\r\n\t\r\n\tattemptLogin = (email, password) => {\r\n\t\tthis.props.firebase.doSignInWithEmail(email, password).then(() => {\r\n\t\t\tnavigate(\"/control-panel\");\r\n\t\t}).catch((err) => {\r\n\t\t\tconsole.log(err);\r\n\t\t\tthis.setErrorMsg(\"Login Failed!\");\r\n\t\t});\r\n\t};\r\n\t\r\n\trender() {\r\n\t\tconst { rooms, roomCode, errorMsg } = this.state;\r\n\t\t\r\n\t\tconst room = rooms ? rooms.find((r) => r.id === roomCode) : null;\r\n\t\t\r\n\t\tif (room === null && roomCode !== \"\") {\r\n\t\t\tthis.setErrorMsg(\"Room not found!\");\r\n\t\t}\r\n\t\t\r\n\t\tif (roomCode === \"\")\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse if (room === null || room === undefined)\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<h1> Room not found! </h1>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse if (errorMsg !== \"\")\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Home\" route=\"/\" />\r\n\t\t\t\t\t<StyledCentered>\r\n\t\t\t\t\t\t<Logo size=\"large\"/>\r\n\t\t\t\t\t\t<h1> {this.state.errorMsg} </h1>\r\n\t\t\t\t\t\t<Card setRoomCode={this.setRoomCode} attemptLogin={this.attemptLogin} />\r\n\t\t\t\t\t</StyledCentered>\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t\telse\r\n\t\t\treturn (\r\n\t\t\t    <>\r\n\t\t\t\t\t<SEO title=\"Room\" route=\"/\" />\r\n\t\t\t\t\t<Room room={room} />\r\n\t\t\t\t</>\r\n\t\t\t);\r\n\t}\r\n}\r\n\r\nexport default withFirebase(IndexPage);\r\n"],"sourceRoot":""}